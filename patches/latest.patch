--- a/.github/workflows/apply_patch_pr.yml
+++ b/.github/workflows/apply_patch_pr.yml
@@ -25,43 +25,74 @@
         with:
           ref: ${{ inputs.base_branch }}
 
-      - name: Validate patch file exists
+      - name: Require PR_BOT_TOKEN
+        shell: bash
         run: |
-          if [ ! -f "${{ inputs.patch_path }}" ]; then
-            echo "::error::Patch file not found: ${{ inputs.patch_path }}"
-            echo "Create it in the repo first (Add file -> Upload files / Create new file)."
+          set -euo pipefail
+          if [ -z "${{ secrets.PR_BOT_TOKEN }}" ]; then
+            echo "::error::Missing required secret PR_BOT_TOKEN (fine-grained PAT)."
             exit 1
           fi
 
-      - name: Materialize patch (supports .b64)
+      - name: Validate patch file exists
+        shell: bash
+        run: |
+          set -euo pipefail
+          if [ ! -f "${{ inputs.patch_path }}" ]; then
+            echo "::error::Patch file not found: ${{ inputs.patch_path }}"
+            echo "Tip: add it via GitHub web UI → Add file → Upload files (do not paste)."
+            echo ""
+            echo "Files in patches/:"
+            ls -la patches || true
+            exit 1
+          fi
+
+      - name: Materialize patch
         id: mat
         shell: bash
         run: |
           set -euo pipefail
           SRC="${{ inputs.patch_path }}"
           OUT="/tmp/patch.patch"
-
           cp "$SRC" "$OUT"
-
           echo "out=$OUT" >> "$GITHUB_OUTPUT"
-          echo "---- PATCH PREVIEW (first 40 lines) ----"
-          sed -n '1,40p' "$OUT"
+          echo "---- PATCH PREVIEW (first 60 lines) ----"
+          sed -n '1,60p' "$OUT" || true
 
       - name: Check patch applies cleanly
+        shell: bash
         run: |
+          set -euo pipefail
           git apply --check "${{ steps.mat.outputs.out }}"
 
       - name: Apply patch
+        shell: bash
         run: |
+          set -euo pipefail
           git apply --whitespace=fix "${{ steps.mat.outputs.out }}"
 
       - name: Create Pull Request
+        id: cpr
         uses: peter-evans/create-pull-request@v6
         with:
-          # If PR_BOT_TOKEN exists, use it so PR triggers other workflows. Otherwise fallback to GITHUB_TOKEN.
           token: ${{ secrets.PR_BOT_TOKEN }}
-          branch: patch/apply-${{ github.run_id }}-${{ github.run_attempt }}
+          branch: bot/apply-patch-${{ github.run_id }}-${{ github.run_attempt }}
           base: ${{ inputs.base_branch }}
           title: "Apply patch: ${{ inputs.patch_path }}"
           commit-message: "Apply patch: ${{ inputs.patch_path }}"
           body: "Automated patch apply via workflow_dispatch."
+
+      - name: Enable auto-merge (squash)
+        if: steps.cpr.outputs.pull-request-number != ''
+        uses: peter-evans/enable-pull-request-automerge@v3
+        with:
+          token: ${{ secrets.PR_BOT_TOKEN }}
+          pull-request-number: ${{ steps.cpr.outputs.pull-request-number }}
+          merge-method: squash
+
+      - name: Summary
+        if: always()
+        shell: bash
+        run: |
+          echo "Patch applied from: ${{ inputs.patch_path }}" >> "$GITHUB_STEP_SUMMARY"
+          echo "PR: ${{ steps.cpr.outputs.pull-request-url }}" >> "$GITHUB_STEP_SUMMARY"

--- a/.github/workflows/enable-automerge.yml
+++ b/.github/workflows/enable-automerge.yml
@@ -1,4 +1,4 @@
-name: enable-automerge-for-agents
+name: enable-automerge
 
 on:
   pull_request:
@@ -12,13 +12,26 @@
   enable:
     if: >
       github.event.pull_request.draft == false &&
-      (github.event.pull_request.user.login == 'github-copilot' ||
-       contains(github.event.pull_request.user.login, 'copilot'))
+      (
+        startsWith(github.event.pull_request.head.ref, 'bot/apply-patch-') ||
+        startsWith(github.event.pull_request.head.ref, 'patch/apply-') ||
+        github.event.pull_request.user.login == 'github-copilot' ||
+        contains(github.event.pull_request.user.login, 'copilot')
+      )
     runs-on: ubuntu-latest
+    steps:
+      - name: Require PR_BOT_TOKEN
+        shell: bash
+        run: |
+          set -euo pipefail
+          if [ -z "${{ secrets.PR_BOT_TOKEN }}" ]; then
+            echo "::error::Missing required secret PR_BOT_TOKEN (fine-grained PAT)."
+            exit 1
+          fi
 
-    steps:
       - name: Enable auto-merge (squash)
         uses: peter-evans/enable-pull-request-automerge@v3
         with:
-          token: ${{ secrets.GITHUB_TOKEN }}
+          token: ${{ secrets.PR_BOT_TOKEN }}
+          pull-request-number: ${{ github.event.pull_request.number }}
           merge-method: squash

--- a/.github/workflows/windows-ci.yml
+++ b/.github/workflows/windows-ci.yml
@@ -137,7 +137,7 @@
 
           foreach ($p in $preferred) {
             if (Test-Path $p) {
-              Copy-Item $p 'artifacts\Озонатор.exe' -Force
+              Copy-Item $p 'artifacts\Ozonator.exe' -Force
               $installerOk = $true
               break
             }
@@ -148,7 +148,7 @@
               Sort-Object LastWriteTime -Descending |
               Select-Object -First 1
             if ($exe) {
-              Copy-Item $exe.FullName 'artifacts\Озонатор.exe' -Force
+              Copy-Item $exe.FullName 'artifacts\Ozonator.exe' -Force
               $installerOk = $true
             }
           }
@@ -337,7 +337,7 @@
           $distOk     = "${{ steps.dist.outputs.ok }}"
           $installerOk= "${{ steps.collect.outputs.installer_ok }}"
           $portableOk = "${{ steps.collect.outputs.portable_ok }}"
-          $e2eRan     = "${{ github.event_name == 'workflow_dispatch' && inputs.run_e2e }}"
+          $e2eStatus  = "${{ steps.e2e.outputs.status }}"
           $e2eOk      = "${{ steps.e2e.outputs.ok }}"
           $typeStatus = "${{ steps.typecheck.outputs.status }}"
           $unitStatus = "${{ steps.unit.outputs.status }}"
@@ -375,8 +375,8 @@
             $statusMap[24] = @{ status='FAIL'; why='артефакты не собраны полностью (installer/portable) — см. job logs' }
           }
 
-          # Optional E2E stage 2
-          if ($e2eRan -eq 'true') {
+          # Optional E2E stage 2 (reflects steps.e2e.outputs.status)
+          if ($e2eStatus -eq 'ran') {
             if ($e2eOk -eq 'true') {
               $statusMap[13] = @{ status='PASS'; why='см. logs\e2e.log и playwright-report (если включён)'}
               $statusMap[14] = @{ status='PASS'; why='см. logs\e2e.log и скриншоты (если настроены)'}
@@ -384,10 +384,17 @@
               $statusMap[13] = @{ status='FAIL'; why='см. logs\e2e.log'}
               $statusMap[14] = @{ status='FAIL'; why='см. logs\e2e.log'}
             }
+          } elseif ($e2eStatus -like 'failed*') {
+            $statusMap[13] = @{ status='FAIL'; why="E2E failed: $e2eStatus; см. logs\e2e.log" }
+            $statusMap[14] = @{ status='FAIL'; why="E2E failed: $e2eStatus; см. logs\e2e.log" }
+          } elseif ($e2eStatus -eq 'skipped') {
+            $statusMap[13] = @{ status='NR'; why='E2E skipped (нет playwright.config.ts и/или tests\e2e)' }
+            $statusMap[14] = @{ status='NR'; why='UAT требует реального пользователя; автопрогон будет в этапе 2' }
           } else {
-            $statusMap[13] = @{ status='NR'; why='E2E для Electron (Playwright) не включён в этапе 1' }
-            $statusMap[14] = @{ status='NR'; why='UAT требует реального пользователя; автопрогон будет в этапе 2' }
-          }
+            $statusMap[13] = @{ status='NR'; why="E2E status unknown: $e2eStatus" }
+            $statusMap[14] = @{ status='NR'; why="UAT требует реального пользователя; автопрогон будет в этапе 2" }
+          }
+
 
           $lines = New-Object System.Collections.Generic.List[string]
           $lines.Add('TestReport — Windows CI (GitHub Actions)')
@@ -405,7 +412,7 @@
           $lines.Add(' - logs\e2e.log (если запускался)')
           $lines.Add('')
           $lines.Add('Артефакты (ожидаемые):')
-          $lines.Add(' - artifacts\Озонатор.exe')
+          $lines.Add(' - artifacts\Ozonator.exe')
           $lines.Add(' - artifacts\portable-win-unpacked.zip')
           $lines.Add(' - artifacts\TestReport.txt')
 
@@ -443,12 +450,12 @@
           $out = Join-Path $PWD 'artifacts\TestReport.txt'
           $lines | Out-File -FilePath $out -Encoding UTF8
 
-      - name: Upload artifact — Озонатор.exe
+      - name: Upload artifact — Ozonator.exe
         if: always()
         uses: actions/upload-artifact@v4
         with:
           name: Ozonator.exe
-          path: artifacts/Озонатор.exe
+          path: artifacts/Ozonator.exe
           if-no-files-found: warn
 
       - name: Upload artifact — portable-win-unpacked.zip

--- a/.github/workflows/publish-nightly.yml
+++ b/.github/workflows/publish-nightly.yml
@@ -65,7 +65,11 @@
             $hasPortable = $true
           }
 
-          "exe_path=$($exe.FullName)" | Out-File -FilePath $env:GITHUB_OUTPUT -Append
+          $stableExe = Join-Path $PWD "Ozonator.exe"
+
+          Copy-Item $exe.FullName $stableExe -Force
+
+          "exe_path=$stableExe" | Out-File -FilePath $env:GITHUB_OUTPUT -Append
           "portable_ok=$($hasPortable.ToString().ToLower())" | Out-File -FilePath $env:GITHUB_OUTPUT -Append
           "portable_zip=$portableZip" | Out-File -FilePath $env:GITHUB_OUTPUT -Append
 
