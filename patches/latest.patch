--- a/electron/main/ozon.ts
+++ b/electron/main/ozon.ts
@@ -254,6 +254,70 @@
   return null
 }
 
+function isReasonableStoreName(s: string): boolean {
+  const t = s.trim()
+  if (!t) return false
+  // Название магазина обычно короткое. Длинные строки часто оказываются "мусором" (токены/идентификаторы).
+  if (t.length > 120) return false
+  // Похоже на base64/hex/токен — не принимаем как имя магазина.
+  if (/^[A-Za-z0-9+/_-]{40,}$/.test(t)) return false
+  return true
+}
+
+function deepPickFirstString(root: any, keys: string[]): string | null {
+  const want = new Set(keys.map(k => k.toLowerCase()))
+  const seen = new Set<any>()
+  const q: any[] = [root]
+  let guard = 0
+
+  while (q.length && guard < 5000) {
+    const cur = q.shift()
+    guard++
+
+    if (cur == null) continue
+
+    if (typeof cur !== 'object') continue
+
+    if (seen.has(cur)) continue
+    seen.add(cur)
+
+    if (Array.isArray(cur)) {
+      for (const it of cur) {
+        if (it && typeof it === 'object') q.push(it)
+      }
+      continue
+    }
+
+    for (const [kRaw, v] of Object.entries(cur)) {
+      const k = String(kRaw).toLowerCase()
+
+      if (want.has(k)) {
+        if (typeof v === 'string' && isReasonableStoreName(v)) return v.trim()
+
+        if (v && typeof v === 'object') {
+          const candidate = pickFirstString(
+            (v as any).name,
+            (v as any).title,
+            (v as any).value,
+            (v as any).company_name,
+            (v as any).companyName,
+            (v as any).seller_name,
+            (v as any).sellerName,
+            (v as any).shop_name,
+            (v as any).shopName,
+          )
+          if (candidate && isReasonableStoreName(candidate)) return candidate.trim()
+        }
+      }
+
+      if (v && typeof v === 'object' && !seen.has(v)) q.push(v)
+    }
+  }
+
+  return null
+}
+
+
 // ---------------- Public API ----------------
 
 export async function ozonTestAuth(secrets: Secrets) {
@@ -288,6 +352,27 @@
         j?.companyName,
       )
       if (name) return name
+
+      // На части кабинетов нужное поле лежит глубже (например result.company.name).
+      // Поэтому делаем «глубокий» поиск по дереву ответа, но с защитой от мусорных длинных строк.
+      const deep = deepPickFirstString(r, [
+        'name',
+        'company_name',
+        'companyName',
+        'seller_name',
+        'sellerName',
+        'shop_name',
+        'shopName'
+      ]) ?? deepPickFirstString(j, [
+        'name',
+        'company_name',
+        'companyName',
+        'seller_name',
+        'sellerName',
+        'shop_name',
+        'shopName'
+      ])
+      if (deep) return deep
     } catch (e: any) {
       const st = e?.details?.status
       if (st && st !== 404) {
--- a/src/renderer/src/ui/pages/ProductsPage.tsx
+++ b/src/renderer/src/ui/pages/ProductsPage.tsx
@@ -142,9 +142,15 @@
   const [dropHint, setDropHint] = useState<{ id: string; side: 'left' | 'right'; x: number } | null>(null)
 
   const [collapsedOpen, setCollapsedOpen] = useState(false)
+  const [bodyScrollTop, setBodyScrollTop] = useState(0)
+  const [bodyViewportH, setBodyViewportH] = useState(600)
+
   const collapsedBtnRef = useRef<HTMLButtonElement | null>(null)
   const collapsedMenuRef = useRef<HTMLDivElement | null>(null)
 
+  const scrollTopRafRef = useRef<number | null>(null)
+  const lastScrollTopRef = useRef(0)
+
   const resizingRef = useRef<{
     id: string
     startX: number
@@ -602,48 +608,106 @@
     }
   }, [visibleCols.length])
 
+
+  // Виртуализация строк: резко снижает лаги при переключении вкладок и при ресайзе колонок
+  useEffect(() => {
+    const body = bodyScrollRef.current
+    if (!body) return
+
+    const updateViewport = () => setBodyViewportH(body.clientHeight || 0)
+    updateViewport()
+
+    // eslint-disable-next-line no-undef
+    const ro = new ResizeObserver(() => updateViewport())
+    ro.observe(body)
+    return () => ro.disconnect()
+  }, [])
+
+  useEffect(() => {
+    const body = bodyScrollRef.current
+    if (!body) return
+
+    const onScroll = () => {
+      lastScrollTopRef.current = body.scrollTop
+      if (scrollTopRafRef.current != null) return
+
+      scrollTopRafRef.current = window.requestAnimationFrame(() => {
+        scrollTopRafRef.current = null
+        setBodyScrollTop(lastScrollTopRef.current)
+      })
+    }
+
+    body.addEventListener('scroll', onScroll, { passive: true })
+    onScroll()
+
+    return () => {
+      body.removeEventListener('scroll', onScroll)
+      if (scrollTopRafRef.current != null) {
+        window.cancelAnimationFrame(scrollTopRafRef.current)
+        scrollTopRafRef.current = null
+      }
+    }
+  }, [])
+
+  const ROW_H = 28
+  const OVERSCAN = 12
+
+  const totalRows = filtered.length
+  const viewH = bodyViewportH || 600
+  const startRow = Math.max(0, Math.floor(bodyScrollTop / ROW_H) - OVERSCAN)
+  const endRow = Math.min(totalRows, startRow + Math.ceil(viewH / ROW_H) + (OVERSCAN * 2))
+
+  const visibleRows = useMemo(() => filtered.slice(startRow, endRow), [filtered, startRow, endRow])
+  const topSpace = startRow * ROW_H
+  const bottomSpace = Math.max(0, (totalRows - endRow) * ROW_H)
+
   return (
     <div className="card productsCard">
-      {hiddenCols.length > 0 && (
-        <div className="collapsedDropdownRow">
-          <button
-            type="button"
-            className="collapsedPlusBtn"
-            ref={collapsedBtnRef}
-            title="Показать скрытый столбец"
-            aria-haspopup="menu"
-            aria-expanded={collapsedOpen}
-            onMouseDown={(e) => e.preventDefault()}
-            onClick={() => setCollapsedOpen(v => !v)}
-          >
-            +
-          </button>
-
-          {collapsedOpen && (
-            <div className="collapsedMenu" ref={collapsedMenuRef} role="menu">
-              {hiddenCols.map(c => (
-                <button
-                  type="button"
-                  key={String(c.id)}
-                  className="collapsedMenuItem"
-                  role="menuitem"
-                  onMouseDown={(e) => e.preventDefault()}
-                  onClick={() => {
-                    showCol(String(c.id))
-                    setCollapsedOpen(false)
-                  }}
+      <div className="productsTableArea">
+        <div className="tableWrap" style={{ marginTop: 4, position: 'relative' }}>
+          <div className="resizeIndicator" ref={resizeIndicatorRef} style={{ display: 'none' }} />
+          {hiddenCols.length > 0 && (
+            <div className="collapsedCorner" style={{ position: 'absolute', top: 6, right: 6, zIndex: 5 }}>
+              <button
+                type="button"
+                className="colToggle colTogglePlus"
+                ref={collapsedBtnRef}
+                title="Показать скрытый столбец"
+                aria-haspopup="menu"
+                aria-expanded={collapsedOpen}
+                onMouseDown={(e) => e.preventDefault()}
+                onClick={() => setCollapsedOpen(v => !v)}
+              >
+                +
+              </button>
+
+              {collapsedOpen && (
+                <div
+                  className="collapsedMenu"
+                  ref={collapsedMenuRef}
+                  role="menu"
+                  style={{ position: 'absolute', top: '100%', right: 0, marginTop: 6, zIndex: 6 }}
                 >
-                  {c.title}
-                </button>
-              ))}
+                  {hiddenCols.map(c => (
+                    <button
+                      type="button"
+                      key={String(c.id)}
+                      className="collapsedMenuItem"
+                      role="menuitem"
+                      style={{ padding: '6px 10px', lineHeight: 1.1 }}
+                      onMouseDown={(e) => e.preventDefault()}
+                      onClick={() => {
+                        showCol(String(c.id))
+                        setCollapsedOpen(false)
+                      }}
+                    >
+                      {c.title}
+                    </button>
+                  ))}
+                </div>
+              )}
             </div>
           )}
-        </div>
-      )}
-
-      <div className="productsTableArea">
-        <div className="tableWrap" style={{ marginTop: 12 }}>
-          <div className="resizeIndicator" ref={resizeIndicatorRef} style={{ display: 'none' }} />
           <div className="tableHeadX" ref={headScrollRef}>
             <div className="tableWrapY tableHeadInner" ref={headInnerRef} style={{ width: tableWidth }}>
               {dropHint && <div className="dropIndicator" style={{ left: dropHint.x }} />}
@@ -698,7 +762,13 @@
                   ))}
                 </colgroup>
                 <tbody>
-                  {filtered.map(p => (
+                  {topSpace > 0 && (
+                    <tr className="spacerRow">
+                      <td colSpan={visibleCols.length} style={{ height: topSpace, padding: 0, border: 'none' }} />
+                    </tr>
+                  )}
+
+                  {visibleRows.map(p => (
                     <tr key={p.offer_id}>
                       {visibleCols.map(c => {
                         const id = String(c.id)
@@ -712,6 +782,13 @@
                     </tr>
                   ))}
 
+                  {bottomSpace > 0 && (
+                    <tr className="spacerRow">
+                      <td colSpan={visibleCols.length} style={{ height: bottomSpace, padding: 0, border: 'none' }} />
+                    </tr>
+                  )}
+
+
                   {filtered.length === 0 && (
                     <tr>
                       <td colSpan={visibleCols.length} className="empty">Ничего не найдено.</td>
